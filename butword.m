%清理
clc;clf;
%冲击响应不变法设计巴特沃斯数字低通滤波器
Fs=20000;
%设置通带和阻带截止频率
fp=1000;
fs=4000;
Wp=2*pi*fp;
Ws=2*pi*fs;
%设置通带最大衰减和阻带最小衰减
Ap=3;
As=15;
%调用buttord函数
[n,Wn]=buttord(Wp,Ws,Ap,As,'s');
%设计滤波器
[B,A]=butter(n,Wn,'s');
%指定一段频率值
W=linspace(0,pi,20000);
%调用冲激响应不变法
[bz,az]=impinvar(B,A,Fs);
%返回频率响应
Hz=freqz(bz,az,W);
%draw
subplot(121);plot(W/pi,20*log(abs(Hz)));  %绘制巴特沃斯数字低通滤波器的幅频特性曲线
xlabel('频率归一化');ylabel('幅值');title('巴特沃斯数字滤波器');
subplot(122);plot(W/pi,angle(Hz));  %绘制巴特沃斯数字低通滤波器的幅频特性曲线
xlabel('频率/Hz');ylabel('相位');title('巴特沃斯数字滤波器');
wp=2*pi*1000; 
ws=2*pi*4000; 
rp=3;
rs=15;
fs=20000;
[n,wn]=buttord(wp,ws,rp,rs,'s')
[z,p,k]=buttap(n)
[b,a]=zp2tf(z,p,k);
[bt,at]=lp2lp(b,a,wp)
[bz,az]=impinvar(bt,at,fs)
freqz(bz,az)